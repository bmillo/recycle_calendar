/*jslint node: true */
'use strict';

var cities = {
    "cities": [
        {
            "name": "Z端rich",
            "zones": [
                {
                    "description": "Nord"
                },
                {
                    "description": "S端d"
                }
            ]
        },
        {
            "name": "Zurzach",
            "zones": [
                {
                    "description": "Nord"
                },
                {
                    "description": "S端d"
                }
            ]
        },
        {
            "name": "Basel",
            "zones": [
                {
                    "description": "Nord"
                },
                {
                    "description": "S端d"
                }
            ]
        }
    ]
};


exports.getAllCities = function (callback) {
    callback(cities);
};

exports.getCitiesByName = function (searchQuery, callback) {
    var filteredCities = [],
        regPattern = new RegExp(".*" + searchQuery + ".*", "i");
    try {
        cities.cities.forEach(function (entry) {
            if (entry.name.match(regPattern)) {
                console.log("pushing city: " + entry);
                filteredCities.push(entry);
            }
        });
        callback({
            "cities": filteredCities
        });
    } catch (err) {
        callback([], "could not filter cities with given search query");
    }
};